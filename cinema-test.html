<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ƒê·∫∑t v√© xem phim</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .seat {
      width: 40px;
      height: 40px;
      margin: 5px;
      background-color: #444;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      border-radius: 0.375rem;
      cursor: pointer;
      color: white;
      transition: background-color 0.3s;
    }
    .seat.selected {
      background-color: #dc2626;
    }
    .seat.taken {
      background-color: #6b7280;
      cursor: not-allowed;
    }
  </style>
</head>
<body class="bg-black text-white">
  <header class="bg-red-700 text-center py-4 text-white text-3xl font-bold shadow">üé¨ ƒê·∫∑t v√© xem phim</header>

  <main class="container my-5 p-4 bg-zinc-900 rounded shadow-lg">
    <div class="mb-4 row g-3">
      <div class="col-md-6">
        <label class="form-label">Ch·ªçn phim:</label>
        <select id="movie" class="form-select bg-zinc-800 text-white border-red-700" onchange="renderSeats()">
          <option value="Avengers">Avengers</option>
          <option value="Spiderman">Spiderman</option>
          <option value="Conan">Detective Conan</option>
        </select>
      </div>
      <div class="col-md-6">
        <label class="form-label">Ch·ªçn su·∫•t:</label>
        <select id="time" class="form-select bg-zinc-800 text-white border-red-700" onchange="renderSeats()">
          <option value="10:00">10:00</option>
          <option value="14:00">14:00</option>
          <option value="18:00">18:00</option>
        </select>
      </div>
    </div>

    <div class="mb-4">
      <h3 class="text-lg font-semibold mb-2">Ch·ªçn gh·∫ø:</h3>
      <div id="seat-container" class="bg-zinc-800 p-4 rounded"></div>
    </div>

    <div class="mb-4 text-white">
      <p><span class="inline-block w-6 h-6 bg-[#444] rounded mr-2"></span> Gh·∫ø kh·∫£ d·ª•ng</p>
      <p><span class="inline-block w-6 h-6 bg-gray-500 rounded mr-2"></span> Gh·∫ø ƒë√£ ƒë·∫∑t</p>
      <p><span class="inline-block w-6 h-6 bg-red-700 rounded mr-2"></span> Gh·∫ø ƒëang ch·ªçn</p>
    </div>

    <div class="mb-4 text-center">
      <button onclick="bookTickets()" class="btn btn-danger px-4 py-2">üéüÔ∏è ƒê·∫∑t v√©</button>
    </div>

    <div class="mb-4">
      <h3 class="text-lg font-semibold mb-2">K·∫øt qu·∫£:</h3>
      <div id="result" class="p-3 bg-zinc-800 border-l-4 border-red-700"></div>
      <div id="total" class="mt-2 text-lg font-bold text-red-500"></div>
    </div>
  </main>

  <script>
    const seatContainer = document.getElementById("seat-container");
    const resultDiv = document.getElementById("result");
    const totalDiv = document.getElementById("total");
    const rows = 5, cols = 8;
    const pricePerSeat = 50000;

    const bookedSeats = {
      Avengers: {
        "10:00": ["A1", "B3"],
        "14:00": ["C2"],
        "18:00": []
      },
      Spiderman: {
        "10:00": ["B2"],
        "14:00": ["C4", "D1"],
        "18:00": []
      },
      Conan: {
        "10:00": [],
        "14:00": ["A4"],
        "18:00": ["E1"]
      }
    };

    function renderSeats() {
      seatContainer.innerHTML = "";
      const movie = document.getElementById("movie").value;
      const time = document.getElementById("time").value;
      const takenSeats = bookedSeats[movie][time] || [];

      for (let row = 0; row < rows; row++) {
        const rowLetter = String.fromCharCode(65 + row);
        for (let col = 1; col <= cols; col++) {
          const seatId = rowLetter + col;
          const seat = document.createElement("div");
          seat.className = "seat";
          seat.textContent = seatId;
          seat.dataset.id = seatId;

          if (takenSeats.includes(seatId)) {
            seat.classList.add("taken");
          } else {
            seat.addEventListener("click", () => {
              seat.classList.toggle("selected");
            });
          }

          seatContainer.appendChild(seat);
        }
        seatContainer.appendChild(document.createElement("br"));
      }
    }

    function bookTickets() {
      const movie = document.getElementById("movie").value;
      const time = document.getElementById("time").value;
      const selected = document.querySelectorAll(".seat.selected");
      if (selected.length === 0) {
        alert("Vui l√≤ng ch·ªçn √≠t nh·∫•t m·ªôt gh·∫ø!");
        return;
      }

      const seats = Array.from(selected).map(seat => seat.dataset.id);
      const totalPrice = seats.length * pricePerSeat;

      resultDiv.innerHTML = `B·∫°n ƒë√£ ƒë·∫∑t v√© cho phim <b>${movie}</b> l√∫c <b>${time}</b><br>Gh·∫ø: <b>${seats.join(", ")}</b>`;
      totalDiv.innerHTML = `T·ªïng ti·ªÅn: <b>${totalPrice.toLocaleString()} VND</b>`;

      // C·∫≠p nh·∫≠t bookedSeats v√† l√†m l·∫°i giao di·ªán
      bookedSeats[movie][time] = bookedSeats[movie][time].concat(seats);
      renderSeats();
    }

    window.onload = renderSeats;
  </script>
</body>
</html>
